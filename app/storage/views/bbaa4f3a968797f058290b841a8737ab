<?php $no = $start_no; $user = Sentry::getUser(); ?>

<?php foreach($records as $record): ?>
<tr>
	<td class="text-center"><?php echo $no++; ?></td>
	<?php foreach($indexFields as $field => $structure): ?>
	<?php if( in_array($structure['type'], $numeric_types) ): ?>
	<td class="text-right">
		<?php elseif( in_array($structure['type'], $option_types) ): ?>
		<td class="text-center">
			<?php else: ?>
			<td class="text-left">
				<?php endif; ?>
				<?php echo AvelcaController::viewIndexContent($record, $structure, $field); ?>       
			</td>
			<?php endforeach; ?>
			<td class="text-center" id="actionColumn">

				<div class="btn-group">
					<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
						<i class="fa fa-fw fa-list"></i> <span class="caret"></span>
					</button>
					<ul class="dropdown-menu text-left" role="menu">
						<?php if($user->hasAccess($routeName.'.view')): ?>
						<?php if( ! in_array('view', $disabledActions) ): ?>		
						<li><a href="<?php echo URL::to('admin/'.$routeName.'/view/'.$record->id); ?>" data-toggle="modal" data-target="#viewModal">View</a></li>
						<?php endif; ?>
						<?php endif; ?>

						<?php if($user->hasAccess($routeName.'.edit')): ?>
						<?php if( ! in_array('edit', $disabledActions) ): ?>				
						<li><a href="<?php echo URL::to('admin/'.$routeName.'/edit/'.$record->id); ?>" data-toggle="modal" data-target="#updateModal">Update</a></li>
						<?php endif; ?>
						<?php endif; ?>

						<?php if($user->hasAccess($routeName.'.delete')): ?>
						<?php if( ! in_array('delete', $disabledActions) ): ?>
						<li><a href="<?php echo URL::to('admin/'.$routeName.'/delete/'.$record->id); ?>" data-toggle="modal" data-target="#removeModal">Remove</a></li>
						<?php endif; ?>
						<?php endif; ?>

						<?php if( count($actionButtons) > 0): ?>

						<?php if( ! in_array('view', $disabledActions) && ! in_array('edit', $disabledActions) && ! in_array('delete', $disabledActions) ): ?>
						<li class="divider"></li>
						<?php endif; ?>

						<?php foreach($actionButtons as $action_button => $url): ?>
						<?php
						$url = explode('|', $url);
						$param = '';

						if(count($url) > 1)
						{
							$parameters = explode('/', $url[1]);
							for($i = 0; $i < count($parameters); $i++)
							{
								if($i == 0)
								{
									$param .= '/';
								}
								$param .= $record->$parameters[$i];

								if($i != count($parameters))
								{
									$param .= '/';
								}
							}
						}
						?>
						<?php if($user->hasAccess($routeName.'.'.$url[0])): ?>
						<li><a href="<?php echo URL::to('admin/'.$routeName.'/'.$url[0].$param); ?>"><?php echo $action_button; ?></a></li>
						<?php endif; ?>

						<?php endforeach; ?>
						<?php endif; ?>

						<?php $customView = 'admin.'.$routeName.'.menu.action'; ?>
						<?php if(View::exists($customView)): ?>
						<?php echo $__env->make($customView, array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
						<?php endif; ?>
					</ul>
				</div>

			</td>
		</tr>
		<?php endforeach; ?>